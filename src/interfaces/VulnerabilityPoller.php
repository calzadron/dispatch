<?php

namespace dispatch\core\interfaces;

$app = __DIR__.'/..';

require_once $app.'/interfaces/MatchHandler.php';
require_once $app.'/interfaces/VulnerabilityDataSource.php';

use dispatch\core\interfaces\MatchHandler;
use dispatch\core\interfaces\VulnerabilityDataSource;

interface VulnerabilityPoller
{
	/**
	 * @param dispatch\core\interfaces\VulnerabilityDataSource $dataSource
	 */
	public function addVulnerabilityDataSource(
		VulnerabilityDataSource $dataSource
	);

	/**
	 * @param dispatch\core\interfaces\VulnerabilityMatcher $matcher
	 */
	public function addVulnerabilityMatcher(VulnerabilityMatcher $matcher);

	/**
	 * @param string $startDate  Start date of the date range to poll, in YYYY-MM-DD
	 * @param string $endDate  End date of the date range to poll, in YYYY-MM-DD
	 * @return dispatch\core\interfaces\data\VulnerabilityCollection
	 */
	public function pollDateRange($startDate, $endDate);
}


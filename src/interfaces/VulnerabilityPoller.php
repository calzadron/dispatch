<?php

namespace dispatch\core\interfaces;

$app = __DIR__.'/..';

require_once $app.'/interfaces/MatchHandler.php';
require_once $app.'/interfaces/VulnerabilityDataSource.php';

use dispatch\core\interfaces\MatchHandler;
use dispatch\core\interfaces\VulnerabilityDataSource;

interface VulnerabilityPoller
{
	/**
	 * @param dispatch\core\interfaces\VulnerabilityDataSource $dataSource
	 */
	public function addVulnerabilityDataSource(
		VulnerabilityDataSource $dataSource
	);

	/**
	 * @param dispatch\core\interfaces\VulnerabilityMatcher $matcher
	 */
	public function addVulnerabilityMatcher(VulnerabilityMatcher $matcher);

	/**
	 * @param \DateTime $startDate
	 * @param \DateTime $endDate
	 * @return dispatch\core\interfaces\data\VulnerabilityCollection
	 * @throws dispatch\core\exceptions\MissingLogicalDependencyException
	 */
	public function pollDateRange(\DateTime $startDate, \DateTime $endDate);
}

